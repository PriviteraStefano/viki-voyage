---
import {SITE_TITLE} from '../consts';
import HeaderLink from './HeaderLink.astro';
---

<header id="header" class="sticky bg-transparent top-2 z-20 m-2 p-2 transition-all duration-300 ease-in-out">
  <nav class="flex flex-row w-full justify-between items-center">
    <div data-aos="fade-right"
         data-aos-delay="100"
         data-aos-once="true"
         class="flex flex-row p-2 gap-1 rounded-2xl bg-primary text-secondary inset-shadow-sm inset-shadow-primary-foreground"
    >
      <HeaderLink class={"text-lg"} emoji='ðŸ ' href="/">Home</HeaderLink>
      <HeaderLink class={"text-lg"} emoji='ðŸ‘©ðŸ»â€ðŸ’»' href="/blog">Blog</HeaderLink>
      <HeaderLink class={"text-lg"} emoji='ðŸ“šï¸' href="/books">Books</HeaderLink>
      <HeaderLink class={"text-lg"} emoji='ðŸ‘©ðŸ»â€âš•ï¸' href="/about">About Me</HeaderLink>
    </div>
    <a
        data-aos="fade-left"
        data-aos-delay="100"
        class="align-middle italic" href="/">
      <h2

          class="align-middle h-fit py-2 px-4 rounded-4xl text-lg inset-shadow-sm inset-shadow-primary-foreground
         text-secondary transition-colors ease-linear duration-400 delay-150 hover:bg-secondary hover:text-primary-foreground "
      >
        {SITE_TITLE}
      </h2>
    </a>
  </nav>
</header>
<script>
  // Observe the header element for intersection
  function onScroll(_: Event) {
    const header = document.getElementById("header");
    const main = document.getElementById("main");
    const headerRect = header!.getBoundingClientRect();
    const mainRect = main!.getBoundingClientRect();

    const overlap = !(
      headerRect.bottom < mainRect.top ||
      headerRect.top > mainRect.bottom
    );

    if (overlap) {
      header!.classList.add("backdrop-blur-lg", "bg-background/30", "p-2", "rounded-2xl", "inset-shadow-sm", "inset-shadow-primary-foreground");
      header!.classList.remove("bg-transparent");
    } else {
      header!.classList.remove("bg-background");
      header!.classList.add("bg-transparent");
    }
  }

  window.addEventListener("scroll", onScroll);

</script>