---
import {SITE_TITLE} from '../consts';
import HeaderLink from './HeaderLink.astro';
---

<header id="header" class="sticky top-2 z-20 m-2 transition-all duration-300 ease-in-out [&>*>div]:inset-shadow-sm [&>*>div]:inset-shadow-background
        ">
  <nav class="flex flex-row w-full justify-between items-center">
    <div data-aos="fade-right"
         data-aos-delay="100"
         data-aos-once="true"
         class="flex flex-row p-2 gap-1 rounded-2xl bg-primary/80 text-secondary"
    >
      <HeaderLink emoji='ðŸ ' href="/">Home</HeaderLink>
      <HeaderLink emoji='ðŸ‘©ðŸ»â€ðŸ’»' href="/blog">Blog</HeaderLink>
      <HeaderLink emoji='ðŸ“šï¸' href="/books">Books</HeaderLink>
      <HeaderLink emoji='ðŸ‘©ðŸ»â€âš•ï¸' href="/about">About Me</HeaderLink>
    </div>
    <a
        data-aos="fade-left"
        data-aos-delay="100"
        class="align-middle font-serif" href="/">
      <h2
          class="align-middle
          inset-shadow-primary
           h-fit py-2 px-4 rounded-4xl text-lg inset-shadow-sm bg-secondary text-primary-foreground
           hover:inset-shadow-xs hover:inset-shadow-foreground hover:scale-[0.95] transition-all duration-200 ease-in-out"
      >
        {SITE_TITLE}
      </h2>
    </a>
  </nav>
</header>

<script>
  // Observe the header element for intersection
  function onScroll(_: Event) {
    const header = document.getElementById("header");
    const main = document.getElementById("main");
    const headerRect = header!.getBoundingClientRect();
    const mainRect = main!.getBoundingClientRect();

    const overlap = !(
      headerRect.bottom < mainRect.top ||
      headerRect.top > mainRect.bottom
    );

    if (overlap) {
      header!.classList.add(
        "backdrop-blur-lg",
        "bg-primary/60",
        "p-2",
        "rounded-2xl",
        "inset-shadow-sm",
        "inset-shadow-primary-foreground",
        "[&>*>div]:bg-transparent",
      );
      header!.classList.remove(
        "bg-transparent",
        "[&>*>div]:inset-shadow-sm",
        "[&>*>div]:bg-primary"
      );
    } else {
      header!.classList.remove(
        "backdrop-blur-lg",
        "bg-primary/60",
        "p-2",
        "rounded-2xl",
        "inset-shadow-sm",
        "inset-shadow-primary-foreground",
        "[&>*>div]:bg-transparent"
      );
      header!.classList.add(
        "bg-transparent",
        "[&>*>div]:inset-shadow-sm",
        "[&>*>div]:bg-primary",
      );
    }
  }

  window.addEventListener("scroll", onScroll);
</script>